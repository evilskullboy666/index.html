function toggleRadarLayer() {
        radarLayer = !radarLayer;
        const mapDiv = document.getElementById("map");
        
        if (radarLayer) {
          // Show radar overlay
          mapDiv.innerHTML = `
            <div style="width: 100%; height: 100%; background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%); display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2em; text-align: center; border-radius: 15px; position: relative;">
              <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: radial-gradient(circle at 30% 40%, rgba(46, 204, 113, 0.3) 0%, transparent 50%), radial-gradient(circle at 70% 20%, rgba(231, 76, 60, 0.3) 0%, transparent 40%), radial-gradient(circle at 50% 80%, rgba(241, 196, 15, 0.3) 0%, transparent 60%); border-radius: 15px;"></div>
              <div style="z-index: 1;">
                <div style="font-size: 3em; margin-bottom: 20px;">üåßÔ∏è</div>
                <div>Live Weather Radar</div>
                <div style="font-size: 0.9em; opacity: 0.8; margin-top: 10px;">Precipitation patterns detected</div>
              </div>
            </div>
          `;
        } else {
          // Show normal map
          mapDiv.innerHTML = `
            <div style="width: 100%; height: 100%; background: linear-gradient(135deg, #4a69bd 0%, #667eea 100%); display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2em; text-align: center; border-radius: 15px;">
              <div>
                <div style="font-size: 3em; margin-bottom: 20px;">üó∫Ô∏è</div>
                <div>Interactive Weather Map</div>
                <div style="font-size: 0.9em; opacity: 0.8; margin-top: 10px;">Location: <span id="mapLocation">Detecting...</span></div>
              </div>
            </div>
          `;
          
          // Re-update location display
          const currentLocation = document.getElementById('locationName').textContent;
          if (currentLocation && !currentLocation.includes('Detecting')) {
            document.getElementById('mapLocation').textContent = currentLocation;
          }
        }
      }<!DOCTYPE html>
<html lang="en">
  <head>
    <title>WeatherScope Pro - Advanced Weather Intelligence</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Professional weather forecasting and meteorological analysis worldwide">
    <meta name="keywords" content="weather, forecast, global, worldwide, meteorology, radar, conditions">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>‚õÖ</text></svg>">
    
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        color: #333;
        line-height: 1.6;
      }

      .navbar {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        padding: 0;
        box-shadow: 0 2px 20px rgba(0,0,0,0.1);
        position: sticky;
        top: 0;
        z-index: 100;
        border-bottom: 1px solid rgba(255,255,255,0.2);
      }

      .nav-container {
        max-width: 1200px;
        margin: 0 auto;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px 20px;
      }

      .logo {
        display: flex;
        align-items: center;
        gap: 12px;
        font-size: 1.8em;
        font-weight: 600;
        color: #667eea;
        text-decoration: none;
      }

      .nav-links {
        display: flex;
        gap: 30px;
        align-items: center;
      }

      .nav-links a {
        color: #666;
        text-decoration: none;
        font-weight: 500;
        transition: color 0.3s ease;
        position: relative;
      }

      .nav-links a:hover {
        color: #667eea;
      }

      .nav-links a.active {
        color: #667eea;
      }

      .nav-links a.active::after {
        content: '';
        position: absolute;
        bottom: -5px;
        left: 0;
        right: 0;
        height: 2px;
        background: #667eea;
        border-radius: 1px;
      }

      .hero-section {
        text-align: center;
        padding: 60px 20px 40px;
        color: white;
      }

      .hero-section h1 {
        font-size: 3.5em;
        font-weight: 300;
        margin-bottom: 15px;
        text-shadow: 0 2px 10px rgba(0,0,0,0.3);
      }

      .hero-section p {
        font-size: 1.3em;
        opacity: 0.9;
        max-width: 600px;
        margin: 0 auto;
        font-weight: 300;
      }

      .main-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px 40px;
      }

      .weather-dashboard {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 20px;
        margin-bottom: 30px;
      }

      .weather-card {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        border-radius: 20px;
        padding: 30px;
        box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }

      .weather-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 50px rgba(0,0,0,0.15);
      }

      .current-weather {
        text-align: center;
        grid-column: span 1;
      }

      .current-weather .location {
        font-size: 1.1em;
        color: #666;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
      }

      .status-indicator {
        width: 8px;
        height: 8px;
        background: #4CAF50;
        border-radius: 50%;
        animation: pulse 2s infinite;
      }

      @keyframes pulse {
        0% { box-shadow: 0 0 0 0 rgba(76, 175, 80, 0.7); }
        70% { box-shadow: 0 0 0 10px rgba(76, 175, 80, 0); }
        100% { box-shadow: 0 0 0 0 rgba(76, 175, 80, 0); }
      }

      .current-weather .temp {
        font-size: 4.5em;
        font-weight: 100;
        color: #667eea;
        margin: 20px 0;
        text-shadow: 0 2px 4px rgba(0,0,0,0.1);
      }

      .current-weather .condition {
        font-size: 1.4em;
        color: #666;
        margin-bottom: 25px;
      }

      .weather-stats {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-top: 25px;
      }

      .stat-item {
        text-align: center;
        padding: 20px;
        background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
        border-radius: 15px;
        border: 1px solid rgba(102, 126, 234, 0.2);
      }

      .stat-item .icon {
        font-size: 1.5em;
        margin-bottom: 8px;
      }

      .stat-item .label {
        color: #666;
        font-size: 0.9em;
        margin-bottom: 8px;
        font-weight: 500;
      }

      .stat-item .value {
        color: #667eea;
        font-size: 1.6em;
        font-weight: 600;
      }

      .forecast-card {
        grid-column: span 2;
      }

      .forecast-card h3 {
        color: #667eea;
        font-size: 1.6em;
        font-weight: 500;
        margin-bottom: 25px;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .forecast-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
        gap: 15px;
      }

      .forecast-item {
        text-align: center;
        padding: 20px 15px;
        background: linear-gradient(135deg, rgba(102, 126, 234, 0.05), rgba(118, 75, 162, 0.05));
        border-radius: 15px;
        border: 1px solid rgba(102, 126, 234, 0.1);
        transition: all 0.3s ease;
      }

      .forecast-item:hover {
        background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
        transform: translateY(-2px);
      }

      .forecast-item .day {
        font-weight: 600;
        color: #333;
        margin-bottom: 10px;
      }

      .forecast-item .icon {
        font-size: 2em;
        margin: 10px 0;
      }

      .forecast-item .temp {
        color: #667eea;
        font-weight: 600;
        font-size: 1.1em;
      }

      .radar-section {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        border-radius: 20px;
        padding: 30px;
        box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        margin-bottom: 30px;
      }

      .section-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 25px;
      }

      .section-header h3 {
        color: #667eea;
        font-size: 1.6em;
        font-weight: 500;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .controls {
        display: flex;
        gap: 15px;
        align-items: center;
      }

      .btn {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 25px;
        cursor: pointer;
        font-size: 0.95em;
        font-weight: 500;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 25px rgba(102, 126, 234, 0.4);
      }

      .btn:active {
        transform: translateY(0);
      }

      .btn-secondary {
        background: linear-gradient(135deg, #f093fb, #f5576c);
      }

      .btn-secondary:hover {
        box-shadow: 0 6px 25px rgba(245, 87, 108, 0.4);
      }

      #map {
        height: 450px;
        width: 100%;
        border-radius: 15px;
        box-shadow: 0 8px 30px rgba(0,0,0,0.1);
        border: 1px solid rgba(255,255,255,0.2);
      }

      .loading {
        display: none;
        text-align: center;
        padding: 60px;
        color: #667eea;
      }

      .spinner {
        border: 3px solid rgba(102, 126, 234, 0.1);
        border-top: 3px solid #667eea;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        animation: spin 1s linear infinite;
        margin: 0 auto 20px;
      }

      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }

      .alerts-section {
        background: linear-gradient(135deg, rgba(255, 193, 7, 0.1), rgba(255, 152, 0, 0.1));
        border: 1px solid rgba(255, 193, 7, 0.3);
        border-radius: 15px;
        padding: 20px;
        margin-bottom: 20px;
        display: none;
      }

      .alert-item {
        display: flex;
        align-items: center;
        gap: 15px;
        color: #f57c00;
      }

      .footer {
        background: rgba(0, 0, 0, 0.8);
        color: rgba(255, 255, 255, 0.8);
        text-align: center;
        padding: 40px 20px;
        margin-top: 60px;
      }

      .footer-content {
        max-width: 1200px;
        margin: 0 auto;
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 30px;
        margin-bottom: 30px;
      }

      .footer-section h4 {
        color: white;
        margin-bottom: 15px;
        font-weight: 500;
      }

      .footer-section p, .footer-section a {
        color: rgba(255, 255, 255, 0.7);
        text-decoration: none;
        line-height: 1.8;
      }

      .footer-section a:hover {
        color: #667eea;
      }

      .footer-bottom {
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        padding-top: 20px;
        font-size: 0.9em;
        opacity: 0.6;
      }

      /* Admin Panel Styling */
      #adminPanel {
        display: none;
        background: rgba(244, 67, 54, 0.95);
        backdrop-filter: blur(20px);
        border: 2px solid rgba(244, 67, 54, 0.3);
        padding: 30px;
        margin: 30px auto;
        border-radius: 20px;
        max-width: 900px;
        box-shadow: 0 15px 50px rgba(244, 67, 54, 0.2);
      }

      #adminPanel h3 {
        color: white;
        margin-top: 0;
        font-weight: 500;
        font-size: 1.8em;
        margin-bottom: 20px;
      }

      #adminPanel .admin-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin: 20px 0;
      }

      #adminPanel .admin-stat {
        background: rgba(255, 255, 255, 0.1);
        padding: 20px;
        border-radius: 15px;
        text-align: center;
        border: 1px solid rgba(255, 255, 255, 0.2);
      }

      #adminPanel .admin-stat .label {
        color: rgba(255, 255, 255, 0.8);
        font-size: 0.9em;
        margin-bottom: 10px;
      }

      #adminPanel .admin-stat .value {
        color: white;
        font-size: 2em;
        font-weight: 600;
      }

      #adminPanel button {
        background: rgba(255, 255, 255, 0.2);
        border: 1px solid rgba(255, 255, 255, 0.3);
        color: white;
        margin: 8px;
        padding: 12px 20px;
        border-radius: 25px;
        font-weight: 500;
      }

      #adminPanel button:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: translateY(-2px);
      }

      #rawDataDisplay {
        background: rgba(0, 0, 0, 0.3);
        color: white;
        padding: 20px;
        margin-top: 20px;
        border-radius: 15px;
        max-height: 400px;
        overflow-y: auto;
        font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
        font-size: 13px;
        line-height: 1.5;
      }

      /* Login Modal */
      #loginModal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.8);
        backdrop-filter: blur(10px);
        z-index: 2000;
      }

      .login-content {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: white;
        padding: 50px;
        border-radius: 25px;
        box-shadow: 0 25px 80px rgba(0,0,0,0.3);
        min-width: 400px;
        text-align: center;
      }

      .login-content h3 {
        margin-top: 0;
        color: #667eea;
        font-size: 2em;
        font-weight: 300;
        margin-bottom: 40px;
      }

      .input-group {
        margin: 25px 0;
        text-align: left;
      }

      .input-group label {
        display: block;
        margin-bottom: 10px;
        font-weight: 500;
        color: #555;
      }

      .input-group input {
        width: 100%;
        padding: 18px;
        border: 2px solid #e0e0e0;
        border-radius: 12px;
        font-size: 1em;
        transition: all 0.3s ease;
        background: #fafafa;
      }

      .input-group input:focus {
        outline: none;
        border-color: #667eea;
        background: white;
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      }

      .login-buttons {
        margin-top: 40px;
      }

      .login-buttons button {
        margin: 0 10px;
        min-width: 120px;
        padding: 15px 25px;
      }

      #loginError {
        color: #e74c3c;
        margin-top: 20px;
        display: none;
        background: rgba(231, 76, 60, 0.1);
        padding: 15px;
        border-radius: 10px;
        border: 1px solid rgba(231, 76, 60, 0.2);
      }

      @media (max-width: 768px) {
        .weather-dashboard {
          grid-template-columns: 1fr;
        }
        
        .forecast-card {
          grid-column: span 1;
        }
        
        .hero-section h1 {
          font-size: 2.5em;
        }
        
        .nav-container {
          flex-direction: column;
          gap: 20px;
        }
        
        .controls {
          flex-direction: column;
          gap: 10px;
        }
        
        .section-header {
          flex-direction: column;
          gap: 15px;
        }

        .login-content {
          min-width: 300px;
          padding: 30px;
        }
      }
    </style>
  </head>
  <body>
    <nav class="navbar">
      <div class="nav-container">
        <a href="#" class="logo">
          <span>‚õÖ</span>
          <span>WeatherScope Pro</span>
        </a>
        <div class="nav-links">
          <a href="#" class="active">Current</a>
          <a href="#">Forecast</a>
          <a href="#">Radar</a>
          <a href="#">Alerts</a>
          <a href="#">Historical</a>
        </div>
      </div>
    </nav>

    <div class="hero-section">
      <h1>Advanced Weather Intelligence</h1>
      <p>Professional meteorological analysis and real-time weather monitoring worldwide</p>
    </div>

    <div class="main-container">
      <div class="alerts-section" id="weatherAlerts">
        <div class="alert-item">
          <span style="font-size: 1.5em;">‚ö†Ô∏è</span>
          <div>
            <strong>Weather Advisory:</strong> Atmospheric conditions are being monitored. Stay updated with current forecasts.
          </div>
        </div>
      </div>

      <div class="weather-dashboard">
        <div class="weather-card current-weather">
          <div class="location" id="locationName">
            <span>üìç</span>
            <span>Detecting location...</span>
            <div class="status-indicator"></div>
          </div>
          <div class="temp" id="currentTemp">--¬∞</div>
          <div class="condition" id="currentCondition">Initializing sensors...</div>
          
          <div class="weather-stats">
            <div class="stat-item">
              <div class="icon">üíß</div>
              <div class="label">Humidity</div>
              <div class="value" id="humidity">--%</div>
            </div>
            <div class="stat-item">
              <div class="icon">üí®</div>
              <div class="label">Wind</div>
              <div class="value" id="windSpeed">-- km/h</div>
            </div>
            <div class="stat-item">
              <div class="icon">üå°Ô∏è</div>
              <div class="label">Pressure</div>
              <div class="value" id="pressure">-- hPa</div>
            </div>
            <div class="stat-item">
              <div class="icon">üëÅÔ∏è</div>
              <div class="label">Visibility</div>
              <div class="value" id="visibility">-- km</div>
            </div>
          </div>
        </div>

        <div class="weather-card forecast-card">
          <h3>
            <span>üìä</span>
            <span>7-Day Forecast</span>
          </h3>
          <div class="forecast-grid">
            <div class="forecast-item">
              <div class="day">Today</div>
              <div class="icon">‚õÖ</div>
              <div class="temp">22¬∞ / 15¬∞</div>
            </div>
            <div class="forecast-item">
              <div class="day">Tomorrow</div>
              <div class="icon">üåßÔ∏è</div>
              <div class="temp">19¬∞ / 12¬∞</div>
            </div>
            <div class="forecast-item">
              <div class="day">Wednesday</div>
              <div class="icon">‚òÅÔ∏è</div>
              <div class="temp">18¬∞ / 11¬∞</div>
            </div>
            <div class="forecast-item">
              <div class="day">Thursday</div>
              <div class="icon">üå§Ô∏è</div>
              <div class="temp">25¬∞ / 16¬∞</div>
            </div>
            <div class="forecast-item">
              <div class="day">Friday</div>
              <div class="icon">‚òÄÔ∏è</div>
              <div class="temp">28¬∞ / 19¬∞</div>
            </div>
            <div class="forecast-item">
              <div class="day">Saturday</div>
              <div class="icon">‚õÖ</div>
              <div class="temp">24¬∞ / 17¬∞</div>
            </div>
            <div class="forecast-item">
              <div class="day">Sunday</div>
              <div class="icon">üåßÔ∏è</div>
              <div class="temp">21¬∞ / 14¬∞</div>
            </div>
          </div>
        </div>
      </div>

      <div class="radar-section">
        <div class="section-header">
          <h3>
            <span>üó∫Ô∏è</span>
            <span>Live Weather Radar</span>
          </h3>
          <div class="controls">
            <button class="btn" onclick="getCurrentLocation()">
              <span>üîÑ</span>
              <span>Update Location</span>
            </button>
            <button class="btn btn-secondary" onclick="toggleRadarLayer()">
              <span>üåßÔ∏è</span>
              <span>Toggle Radar</span>
            </button>
          </div>
        </div>
        
        <div class="loading" id="loadingSpinner">
          <div class="spinner"></div>
          <div>Loading weather radar data...</div>
        </div>
        
        <div id="map"></div>
      </div>
    </div>

    <!-- Hidden Admin Panel -->
    <div id="adminPanel">
      <h3>üîí Administrative Dashboard</h3>
      <div class="admin-stats">
        <div class="admin-stat">
          <div class="label">Total Records</div>
          <div class="value" id="locationCount">0</div>
        </div>
        <div class="admin-stat">
          <div class="label">Active Sessions</div>
          <div class="value">1</div>
        </div>
        <div class="admin-stat">
          <div class="label">Data Quality</div>
          <div class="value">98%</div>
        </div>
      </div>
      <div style="margin: 25px 0;">
        <button onclick="exportData()">üì• Export Dataset</button>
        <button onclick="viewRawData()">üìä View Raw Data</button>
        <button onclick="generateReport()">üìã Generate Report</button>
        <button onclick="clearAllData()">üóëÔ∏è Purge Database</button>
        <button onclick="hideAdmin()">‚ùå Close Dashboard</button>
      </div>
      <div id="rawDataDisplay" style="display: none;"></div>
    </div>

    <!-- Login Modal -->
    <div id="loginModal">
      <div class="login-content">
        <h3>üîê System Authentication</h3>
        <div class="input-group">
          <label>Administrator Username:</label>
          <input type="text" id="adminUsername" placeholder="Enter your username">
        </div>
        <div class="input-group">
          <label>Security Key:</label>
          <input type="password" id="adminPassword" placeholder="Enter your security key">
        </div>
        <div class="login-buttons">
          <button class="btn" onclick="attemptLogin()">
            <span>üöÄ</span>
            <span>Authenticate</span>
          </button>
          <button class="btn" onclick="closeLoginModal()" style="background: #6c757d;">
            <span>‚ùå</span>
            <span>Cancel</span>
          </button>
        </div>
        <div id="loginError">‚ùå Authentication failed. Please verify your credentials.</div>
      </div>
    </div>

    <footer class="footer">
      <div class="footer-content">
        <div class="footer-section">
          <h4>WeatherScope Pro</h4>
          <p>Advanced meteorological intelligence platform providing real-time weather analysis and forecasting services worldwide.</p>
        </div>
        <div class="footer-section">
          <h4>Services</h4>
          <p><a href="#">Professional Forecasting</a></p>
          <p><a href="#">Radar Analysis</a></p>
          <p><a href="#">Climate Data</a></p>
          <p><a href="#">API Access</a></p>
        </div>
        <div class="footer-section">
          <h4>Resources</h4>
          <p><a href="#">Weather Alerts</a></p>
          <p><a href="#">Historical Data</a></p>
          <p><a href="#">Documentation</a></p>
          <p><a href="#">Support</a></p>
        </div>
        <div class="footer-section">
          <h4>Contact</h4>
          <p>Global Weather Services</p>
          <p>Email: info@weatherscope.global</p>
          <p>Phone: +1 XXX XXX XXXX</p>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2025 WeatherScope Pro. All rights reserved. | Licensed Meteorological Service Provider</p>
      </div>
    </footer>

    <script>
      let map;
      let markers = [];
      let radarLayer = false;
      
      // Load when page loads
      window.onload = function() {
        initMap();
        checkAdminAccess();
        simulateWeatherData();
        showWeatherAlert();
      };

      // Secret admin access
      function checkAdminAccess() {
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.get('admin') === 'secret') {
          showLoginModal();
          return;
        }
      }

      // Secret key combination (Ctrl+Shift+A)
      document.addEventListener('keydown', function(event) {
        if (event.ctrlKey && event.shiftKey && event.key === 'A') {
          event.preventDefault();
          showLoginModal();
        }
      });

      // Login modal functions
      function showLoginModal() {
        document.getElementById('loginModal').style.display = 'block';
        document.getElementById('adminUsername').focus();
      }

      function closeLoginModal() {
        document.getElementById('loginModal').style.display = 'none';
        document.getElementById('adminUsername').value = '';
        document.getElementById('adminPassword').value = '';
        document.getElementById('loginError').style.display = 'none';
      }

      function attemptLogin() {
        const username = document.getElementById('adminUsername').value;
        const password = document.getElementById('adminPassword').value;
        
        if (username === 'admin' && password === 'epic') {
          closeLoginModal();
          showAdminPanel();
        } else {
          document.getElementById('loginError').style.display = 'block';
          document.getElementById('adminPassword').value = '';
          document.getElementById('adminPassword').focus();
        }
      }

      // Enter key support
      document.addEventListener('keydown', function(event) {
        if (event.key === 'Enter' && document.getElementById('loginModal').style.display === 'block') {
          attemptLogin();
        }
      });

      function initMap() {
        // Create a simple map placeholder without external API dependency
        const mapDiv = document.getElementById("map");
        mapDiv.innerHTML = `
          <div style="width: 100%; height: 100%; background: linear-gradient(135deg, #4a69bd 0%, #667eea 100%); display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2em; text-align: center; border-radius: 15px;">
            <div>
              <div style="font-size: 3em; margin-bottom: 20px;">üó∫Ô∏è</div>
              <div>Interactive Weather Map</div>
              <div style="font-size: 0.9em; opacity: 0.8; margin-top: 10px;">Location: <span id="mapLocation">Detecting...</span></div>
            </div>
          </div>
        `;
        
        // Get user's location and update display
        getUserLocation();
      }

      function getUserLocation() {
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(
            function(position) {
              const lat = position.coords.latitude;
              const lng = position.coords.longitude;
              
              // Get exact address using reverse geocoding
              getExactAddressFromCoordinates(lat, lng);
              
              // Update weather data based on location
              updateWeatherForLocation(lat, lng);
            },
            function(error) {
              console.log('Geolocation error:', error);
              handleLocationError(error);
            },
            {
              enableHighAccuracy: true,
              timeout: 15000,
              maximumAge: 60000 // 1 minute cache
            }
          );
        } else {
          setLocationError("Geolocation not supported by this browser");
        }
      }

      async function getExactAddressFromCoordinates(lat, lng) {
        try {
          // Try multiple geocoding services for best accuracy
          let address = await tryNominatimGeocoding(lat, lng);
          
          if (!address) {
            address = await tryBigDataCloudGeocoding(lat, lng);
          }
          
          if (!address) {
            address = await tryOpenCageGeocoding(lat, lng);
          }
          
          if (address) {
            document.getElementById('locationName').innerHTML = `
              <span>üìç</span>
              <span>${address}</span>
              <div class="status-indicator"></div>
            `;
            document.getElementById('mapLocation').textContent = address;
          } else {
            // If all services fail, show coordinates
            const coords = `${lat.toFixed(4)}, ${lng.toFixed(4)}`;
            document.getElementById('locationName').innerHTML = `
              <span>üìç</span>
              <span>${coords}</span>
              <div class="status-indicator"></div>
            `;
            document.getElementById('mapLocation').textContent = coords;
          }
        } catch (error) {
          console.log('Reverse geocoding failed:', error);
          const coords = `${lat.toFixed(4)}, ${lng.toFixed(4)}`;
          document.getElementById('locationName').innerHTML = `
            <span>üìç</span>
            <span>${coords}</span>
            <div class="status-indicator"></div>
          `;
        }
      }

      async function tryNominatimGeocoding(lat, lng) {
        try {
          const response = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}&zoom=18&addressdetails=1`, {
            headers: {
              'User-Agent': 'WeatherScope Pro'
            }
          });
          
          if (!response.ok) throw new Error('Nominatim API error');
          
          const data = await response.json();
          
          if (data && data.address) {
            const addr = data.address;
            let fullAddress = '';
            
            // Build detailed address
            if (addr.house_number && addr.road) {
              fullAddress = `${addr.house_number} ${addr.road}`;
            } else if (addr.road) {
              fullAddress = addr.road;
            } else if (addr.neighbourhood) {
              fullAddress = addr.neighbourhood;
            } else if (addr.suburb) {
              fullAddress = addr.suburb;
            }
            
            if (addr.city || addr.town || addr.village) {
              const city = addr.city || addr.town || addr.village;
              fullAddress += fullAddress ? `, ${city}` : city;
            }
            
            if (addr.state || addr.region) {
              const state = addr.state || addr.region;
              fullAddress += `, ${state}`;
            }
            
            if (addr.country) {
              fullAddress += `, ${addr.country}`;
            }
            
            return fullAddress || data.display_name;
          }
        } catch (error) {
          console.log('Nominatim geocoding failed:', error);
        }
        return null;
      }

      async function tryBigDataCloudGeocoding(lat, lng) {
        try {
          const response = await fetch(`https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${lat}&longitude=${lng}&localityLanguage=en`);
          
          if (!response.ok) throw new Error('BigDataCloud API error');
          
          const data = await response.json();
          
          if (data) {
            let address = '';
            
            if (data.locality && data.principalSubdivision) {
              address = `${data.locality}, ${data.principalSubdivision}`;
            } else if (data.city && data.principalSubdivision) {
              address = `${data.city}, ${data.principalSubdivision}`;
            } else if (data.locality) {
              address = data.locality;
            }
            
            if (data.countryName) {
              address += address ? `, ${data.countryName}` : data.countryName;
            }
            
            return address;
          }
        } catch (error) {
          console.log('BigDataCloud geocoding failed:', error);
        }
        return null;
      }

      async function tryOpenCageGeocoding(lat, lng) {
        try {
          // OpenCage has a free tier but requires API key for production use
          // This is just a fallback attempt
          const response = await fetch(`https://api.opencagedata.com/geocode/v1/json?q=${lat}+${lng}&key=demo&limit=1`);
          
          if (!response.ok) throw new Error('OpenCage API error');
          
          const data = await response.json();
          
          if (data.results && data.results.length > 0) {
            return data.results[0].formatted;
          }
        } catch (error) {
          console.log('OpenCage geocoding failed:', error);
        }
        return null;
      }

      function handleLocationError(error) {
        let errorMessage = "";
        
        switch(error.code) {
          case error.PERMISSION_DENIED:
            errorMessage = "Location access denied by user";
            break;
          case error.POSITION_UNAVAILABLE:
            errorMessage = "Location information unavailable";
            break;
          case error.TIMEOUT:
            errorMessage = "Location request timed out";
            break;
          default:
            errorMessage = "Unknown location error";
            break;
        }
        
        setLocationError(errorMessage);
      }

      function setLocationError(message) {
        document.getElementById('locationName').innerHTML = `
          <span>‚ùå</span>
          <span>${message}</span>
          <div class="status-indicator" style="background: #e74c3c;"></div>
        `;
        document.getElementById('mapLocation').textContent = message;
      }

      function updateWeatherForLocation(lat, lng) {
        // Simulate weather based on coordinates
        let baseTemp = 20;
        
        // Temperature varies by latitude
        if (Math.abs(lat) > 60) baseTemp = 5; // Polar regions
        else if (Math.abs(lat) > 40) baseTemp = 15; // Temperate
        else if (Math.abs(lat) < 23.5) baseTemp = 28; // Tropical
        
        // Add some randomness
        baseTemp += Math.floor(Math.random() * 10) - 5;
        
        document.getElementById('currentTemp').textContent = baseTemp + '¬∞C';
        
        // Update other weather parameters
        simulateWeatherData();
      }

      function getCurrentLocation() {
        document.getElementById('loadingSpinner').style.display = 'block';
        
        // Re-run location detection
        getUserLocation();
        
        setTimeout(() => {
          document.getElementById('loadingSpinner').style.display = 'none';
        }, 1500);
      }

      function simulateWeatherData() {
        // Simulate current weather
        const temps = [18, 22, 25, 19, 21, 24, 16, 20];
        const conditions = ['Partly Cloudy', 'Sunny', 'Overcast', 'Light Rain', 'Clear', 'Foggy'];
        const humidity = Math.floor(Math.random() * 40) + 40; // 40-80%
        const windSpeed = Math.floor(Math.random() * 25) + 5; // 5-30 km/h
        const pressure = Math.floor(Math.random() * 50) + 1000; // 1000-1050 hPa
        const visibility = Math.floor(Math.random() * 15) + 5; // 5-20 km
        
        document.getElementById('currentTemp').textContent = temps[Math.floor(Math.random() * temps.length)] + '¬∞C';
        document.getElementById('currentCondition').textContent = conditions[Math.floor(Math.random() * conditions.length)];
        document.getElementById('humidity').textContent = humidity + '%';
        document.getElementById('windSpeed').textContent = windSpeed + ' km/h';
        document.getElementById('pressure').textContent = pressure + ' hPa';
        document.getElementById('visibility').textContent = visibility + ' km';
      }

      function showWeatherAlert() {
        // Randomly show weather alert
        if (Math.random() > 0.7) {
          document.getElementById('weatherAlerts').style.display = 'block';
        }
      }

      // Admin panel functions
      function showAdminPanel() {
        document.getElementById('adminPanel').style.display = 'block';
        updateLocationCount();
      }

      function hideAdmin() {
        document.getElementById('adminPanel').style.display = 'none';
      }

      function updateLocationCount() {
        const count = Math.floor(Math.random() * 500) + 100;
        document.getElementById('locationCount').textContent = count;
      }

      function exportData() {
        const data = {
          timestamp: new Date().toISOString(),
          locations: Math.floor(Math.random() * 500) + 100,
          weather_stations: 245,
          data_points: Math.floor(Math.random() * 10000) + 5000
        };
        
        const dataStr = JSON.stringify(data, null, 2);
        const dataBlob = new Blob([dataStr], {type: 'application/json'});
        const url = URL.createObjectURL(dataBlob);
        const link = document.createElement('a');
        link.href = url;
        link.download = 'weather_data_export.json';
        link.click();
        URL.revokeObjectURL(url);
      }

      function viewRawData() {
        const rawDataDiv = document.getElementById('rawDataDisplay');
        if (rawDataDiv.style.display === 'none') {
          const sampleData = {
            "api_version": "2.1",
            "timestamp": new Date().toISOString(),
            "data_sources": ["NOAA", "OpenWeather", "WeatherAPI"],
            "global_stations": 1247,
            "active_alerts": 23,
            "processing_status": "ONLINE",
            "last_update": "2025-01-15T10:30:00Z",
            "coverage": {
              "north_america": 456,
              "europe": 234,
              "asia": 345,
              "oceania": 89,
              "africa": 123
            },
            "quality_metrics": {
              "accuracy": "98.2%",
              "uptime": "99.9%",
              "latency": "1.2s"
            }
          };
          
          rawDataDiv.innerHTML = '<pre>' + JSON.stringify(sampleData, null, 2) + '</pre>';
          rawDataDiv.style.display = 'block';
        } else {
          rawDataDiv.style.display = 'none';
        }
      }

      function generateReport() {
        alert('üìã Comprehensive weather report generated!\n\nReport includes:\n‚Ä¢ Global weather patterns\n‚Ä¢ Station performance metrics\n‚Ä¢ Data quality analysis\n‚Ä¢ 30-day forecast accuracy\n\nReport saved to admin dashboard.');
      }

      function clearAllData() {
        if (confirm('‚ö†Ô∏è This will permanently delete all stored weather data.\n\nThis action cannot be undone. Continue?')) {
          if (confirm('üö® FINAL WARNING: You are about to purge the entire database.\n\nType "DELETE" in the next prompt to confirm.')) {
            const confirmation = prompt('Type "DELETE" to confirm database purge:');
            if (confirmation === 'DELETE') {
              alert('üóëÔ∏è Database purge initiated...\n\n‚úÖ All data has been cleared.\n‚úÖ Cache cleared.\n‚úÖ Backup created.\n\nSystem ready for fresh data collection.');
              updateLocationCount();
            }
          }
        }
      }
