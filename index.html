<!DOCTYPE html>
<html>
  <head>
    <title>WeatherScope - Local Weather & Conditions</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      
      body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
        min-height: 100vh;
        color: #333;
      }

      .header {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        padding: 20px;
        box-shadow: 0 2px 20px rgba(0,0,0,0.1);
        position: relative;
      }

      .header h1 {
        color: #0984e3;
        font-size: 2.5em;
        font-weight: 300;
        text-align: center;
        margin-bottom: 10px;
      }

      .header .tagline {
        text-align: center;
        color: #636e72;
        font-size: 1.1em;
        font-weight: 300;
      }

      .weather-container {
        max-width: 1200px;
        margin: 30px auto;
        padding: 0 20px;
      }

      .weather-cards {
        display: grid;
        grid-template-columns: 1fr 2fr;
        gap: 20px;
        margin-bottom: 30px;
      }

      .weather-card {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-radius: 20px;
        padding: 25px;
        box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
      }

      .current-weather {
        text-align: center;
      }

      .current-weather .location {
        font-size: 1.2em;
        color: #636e72;
        margin-bottom: 15px;
      }

      .current-weather .temp {
        font-size: 4em;
        font-weight: 100;
        color: #0984e3;
        margin: 10px 0;
      }

      .current-weather .condition {
        font-size: 1.3em;
        color: #636e72;
        margin-bottom: 20px;
      }

      .weather-details {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
        margin-top: 20px;
      }

      .detail-item {
        text-align: center;
        padding: 15px;
        background: rgba(116, 185, 255, 0.1);
        border-radius: 10px;
      }

      .detail-item .label {
        color: #636e72;
        font-size: 0.9em;
        margin-bottom: 5px;
      }

      .detail-item .value {
        color: #0984e3;
        font-size: 1.4em;
        font-weight: 600;
      }

      .map-section {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-radius: 20px;
        padding: 25px;
        box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
      }

      .map-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .map-header h3 {
        color: #0984e3;
        font-size: 1.5em;
        font-weight: 400;
      }

      #controls {
        display: flex;
        gap: 10px;
      }

      button {
        background: linear-gradient(135deg, #74b9ff, #0984e3);
        color: white;
        border: none;
        padding: 12px 20px;
        border-radius: 25px;
        cursor: pointer;
        font-size: 0.9em;
        font-weight: 500;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(116, 185, 255, 0.3);
      }

      button:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(116, 185, 255, 0.4);
      }

      button:active {
        transform: translateY(0);
      }

      #map {
        height: 400px;
        width: 100%;
        border-radius: 15px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      }

      .loading-spinner {
        display: none;
        text-align: center;
        padding: 40px;
        color: #74b9ff;
      }

      .spinner {
        border: 3px solid #f3f3f3;
        border-top: 3px solid #74b9ff;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
        margin: 0 auto 20px;
      }

      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }

      /* Admin Panel Styling */
      #adminPanel {
        display: none;
        background: rgba(244, 67, 54, 0.95);
        backdrop-filter: blur(10px);
        border: 2px solid rgba(244, 67, 54, 0.3);
        padding: 25px;
        margin: 20px auto;
        border-radius: 20px;
        max-width: 800px;
        box-shadow: 0 8px 32px rgba(244, 67, 54, 0.2);
      }

      #adminPanel h3 {
        color: white;
        margin-top: 0;
        font-weight: 400;
      }

      #adminPanel button {
        background: rgba(255, 255, 255, 0.2);
        border: 1px solid rgba(255, 255, 255, 0.3);
        color: white;
        margin: 5px;
      }

      #adminPanel button:hover {
        background: rgba(255, 255, 255, 0.3);
      }

      #rawDataDisplay {
        background: rgba(0, 0, 0, 0.2);
        color: white;
        padding: 15px;
        margin-top: 15px;
        border-radius: 10px;
        max-height: 300px;
        overflow-y: auto;
        font-family: 'Courier New', monospace;
        font-size: 12px;
      }

      /* Login Modal */
      #loginModal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.8);
        backdrop-filter: blur(5px);
        z-index: 1000;
      }

      .login-content {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: white;
        padding: 40px;
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        min-width: 350px;
        text-align: center;
      }

      .login-content h3 {
        margin-top: 0;
        color: #0984e3;
        font-size: 1.8em;
        font-weight: 300;
        margin-bottom: 30px;
      }

      .input-group {
        margin: 20px 0;
        text-align: left;
      }

      .input-group label {
        display: block;
        margin-bottom: 8px;
        font-weight: 500;
        color: #636e72;
      }

      .input-group input {
        width: 100%;
        padding: 15px;
        border: 2px solid #ddd;
        border-radius: 10px;
        font-size: 1em;
        transition: border-color 0.3s ease;
      }

      .input-group input:focus {
        outline: none;
        border-color: #74b9ff;
      }

      .login-buttons {
        margin-top: 30px;
      }

      .login-buttons button {
        margin: 0 10px;
        min-width: 100px;
      }

      #loginError {
        color: #e74c3c;
        margin-top: 15px;
        display: none;
        background: rgba(231, 76, 60, 0.1);
        padding: 10px;
        border-radius: 8px;
      }

      @media (max-width: 768px) {
        .weather-cards {
          grid-template-columns: 1fr;
        }
        
        .header h1 {
          font-size: 2em;
        }
        
        .current-weather .temp {
          font-size: 3em;
        }
        
        #controls {
          flex-direction: column;
        }
        
        .map-header {
          flex-direction: column;
          gap: 15px;
        }
      }
    </style>
  </head>
  <body>
    <div class="header">
      <h1>‚õÖ WeatherScope</h1>
      <div class="tagline">Your Personal Weather & Location Assistant</div>
    </div>

    <div class="weather-container">
      <div class="weather-cards">
        <div class="weather-card current-weather">
          <div class="location" id="locationName">üìç Detecting location...</div>
          <div class="temp">--¬∞</div>
          <div class="condition">Loading weather data...</div>
          
          <div class="weather-details">
            <div class="detail-item">
              <div class="label">Humidity</div>
              <div class="value">--%</div>
            </div>
            <div class="detail-item">
              <div class="label">Wind Speed</div>
              <div class="value">-- mph</div>
            </div>
            <div class="detail-item">
              <div class="label">Pressure</div>
              <div class="value">-- mb</div>
            </div>
            <div class="detail-item">
              <div class="label">Visibility</div>
              <div class="value">-- mi</div>
            </div>
          </div>
        </div>

        <div class="weather-card">
          <h3 style="color: #0984e3; margin-bottom: 20px;">üìä Weather Radar</h3>
          <div class="loading-spinner" id="loadingSpinner">
            <div class="spinner"></div>
            <div>Loading weather radar...</div>
          </div>
          <div style="background: linear-gradient(45deg, #74b9ff, #0984e3); height: 200px; border-radius: 15px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2em;">
            üå¶Ô∏è Interactive Weather Map
          </div>
        </div>
      </div>

      <div class="map-section">
        <div class="map-header">
          <h3>üó∫Ô∏è Your Location</h3>
          <div id="controls">
            <button onclick="getCurrentLocation()">üîÑ Refresh Location</button>
          </div>
        </div>
        <div id="map"></div>
      </div>
    </div>

    <!-- Hidden Admin Panel -->
    <div id="adminPanel">
      <h3>üîí Admin Dashboard</h3>
      <div style="margin: 15px 0; color: rgba(255,255,255,0.9);">
        <strong>Total Location Records:</strong> <span id="locationCount">0</span>
      </div>
      <div style="margin: 15px 0;">
        <button onclick="exportData()">üì• Export All Data</button>
        <button onclick="viewRawData()">üëÅÔ∏è View Raw Data</button>
        <button onclick="clearAllData()">üóëÔ∏è Clear All Data</button>
        <button onclick="hideAdmin()">‚ùå Hide Panel</button>
      </div>
      <div id="rawDataDisplay" style="display: none;"></div>
    </div>

    <!-- Login Modal -->
    <div id="loginModal">
      <div class="login-content">
        <h3>üîê Admin Access</h3>
        <div class="input-group">
          <label>Username:</label>
          <input type="text" id="adminUsername" placeholder="Enter username">
        </div>
        <div class="input-group">
          <label>Password:</label>
          <input type="password" id="adminPassword" placeholder="Enter password">
        </div>
        <div class="login-buttons">
          <button onclick="attemptLogin()">üöÄ Login</button>
          <button onclick="closeLoginModal()" style="background: #636e72;">‚ùå Cancel</button>
        </div>
        <div id="loginError">‚ùå Invalid username or password!</div>
      </div>
    </div>

    <script>
      let map;
      let markers = [];
      
      // Load saved locations when page loads
      window.onload = function() {
        initMap();
        checkAdminAccess();
        simulateWeatherData();
      };

      // Secret admin access
      function checkAdminAccess() {
        // Method 1: URL parameter (?admin=secret)
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.get('admin') === 'secret') {
          showLoginModal();
          return;
        }
      }

      // Secret key combination (Ctrl+Shift+A)
      document.addEventListener('keydown', function(event) {
        if (event.ctrlKey && event.shiftKey && event.key === 'A') {
          event.preventDefault();
          showLoginModal();
        }
      });

      // Login modal functions
      function showLoginModal() {
        document.getElementById('loginModal').style.display = 'block';
        document.getElementById('adminUsername').focus();
      }

      function closeLoginModal() {
        document.getElementById('loginModal').style.display = 'none';
        document.getElementById('adminUsername').value = '';
        document.getElementById('adminPassword').value = '';
        document.getElementById('loginError').style.display = 'none';
      }

      function attemptLogin() {
        const username = document.getElementById('adminUsername').value;
        const password = document.getElementById('adminPassword').value;
        
        // Check credentials
        if (username === 'admin' && password === 'epic') {
          // Success!
          closeLoginModal();
          showAdminPanel();
        } else {
          // Show error
          document.getElementById('loginError').style.display = 'block';
          document.getElementById('adminPassword').value = '';
          document.getElementById('adminPassword').focus();
        }
      }

      // Allow Enter key to submit login
      document.addEventListener('keydown', function(event) {
        if (event.key === 'Enter' && document.getElementById('loginModal').style.display === 'block') {
          attemptLogin();
        }
      });

      function initMap() {
        // Default location (will be overridden when user location is found)
        const defaultLocation = { lat: 0, lng: 0 };
        
        map = new google.maps.Map(document.getElementById("map"), {
          zoom: 2,
          center: defaultLocation,
          styles: [
            {
              "featureType": "all",
              "elementType": "geometry.fill",
              "stylers": [{"color": "#74b9ff"}]
            },
            {
              "featureType": "water",
              "elementType": "geometry",
              "stylers": [{"color": "#0984e3"}]
            }
          ]
        });
        
        // Automatically get location when page loads
        getCurrentLocation();
      }

      function getCurrentLocation() {
        document.getElementById('locationName').innerHTML = 'üìç Detecting location...';
        
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(
            (position) => {
              const myLatLng = {
                lat: position.coords.latitude,
                lng: position.coords.longitude
              };
              
              // Center map on current location
              map.setCenter(myLatLng);
              map.setZoom(15);
              
              // Add marker
              addMarker(myLatLng);
              
              // Save location with timestamp (secretly)
              saveLocation(myLatLng);
              
              // Update location display
              updateLocationDisplay(myLatLng);
              
              console.log("Location tracked:", myLatLng);
            },
            (error) => {
              document.getElementById('locationName').innerHTML = 'üìç Location unavailable';
              console.error("Geolocation error:", error);
            }
          );
        } else {
          document.getElementById('locationName').innerHTML = 'üìç Geolocation not supported';
        }
      }

      function addMarker(location) {
        // Clear existing markers
        markers.forEach(marker => marker.setMap(null));
        markers = [];
        
        const marker = new google.maps.Marker({
          position: location,
          map: map,
          title: "Your current location",
          icon: {
            url: 'data:image/svg+xml;charset=UTF-8,' + encodeURIComponent(`
              <svg width="32" height="32" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
                <circle cx="16" cy="16" r="8" fill="#74b9ff" stroke="white" stroke-width="3"/>
                <circle cx="16" cy="16" r="3" fill="white"/>
              </svg>
            `),
            scaledSize: new google.maps.Size(32, 32),
            anchor: new google.maps.Point(16, 16)
          }
        });
        markers.push(marker);
      }

      function updateLocationDisplay(location) {
        // Simulate reverse geocoding (in real app, you'd use Google's geocoding API)
        document.getElementById('locationName').innerHTML = `üìç Lat: ${location.lat.toFixed(4)}, Lng: ${location.lng.toFixed(4)}`;
      }

      function saveLocation(location) {
        // Get existing locations from browser storage
        let savedLocations = JSON.parse(localStorage.getItem('locationHistory')) || [];
        
        // Add new location with timestamp
        const locationData = {
          lat: location.lat,
          lng: location.lng,
          timestamp: new Date().toISOString(),
          readableTime: new Date().toLocaleString()
        };
        
        savedLocations.push(locationData);
        
        // Keep only last 100 locations to avoid storage issues
        if (savedLocations.length > 100) {
          savedLocations = savedLocations.slice(-100);
        }
        
        // Save back to storage (silently)
        localStorage.setItem('locationHistory', JSON.stringify(savedLocations));
        
        // Optional: console log for debugging (remove in production)
        console.log('Location saved:', locationData);
      }

      function simulateWeatherData() {
        // Simulate weather data (in real app, you'd fetch from weather API)
        setTimeout(() => {
          document.querySelector('.temp').textContent = '72¬∞F';
          document.querySelector('.condition').textContent = 'Partly Cloudy';
          document.querySelectorAll('.detail-item .value')[0].textContent = '65%';
          document.querySelectorAll('.detail-item .value')[1].textContent = '8 mph';
          document.querySelectorAll('.detail-item .value')[2].textContent = '1013 mb';
          document.querySelectorAll('.detail-item .value')[3].textContent = '10 mi';
        }, 2000);
      }

      function exportData() {
        const savedLocations = JSON.parse(localStorage.getItem('locationHistory')) || [];
        
        if (savedLocations.length === 0) {
          alert('No location data to export.');
          return;
        }
        
        // Create CSV content
        let csvContent = "Timestamp,Latitude,Longitude\n";
        savedLocations.forEach(location => {
          csvContent += `"${location.readableTime}",${location.lat},${location.lng}\n`;
        });
        
        // Download CSV file
        const blob = new Blob([csvContent], { type: 'text/csv' });
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'weather_location_data.csv';
        a.click();
        window.URL.revokeObjectURL(url);
      }

      // Admin panel functions
      function showAdminPanel() {
        document.getElementById('adminPanel').style.display = 'block';
        updateLocationCount();
        document.getElementById('adminPanel').scrollIntoView({ behavior: 'smooth' });
      }

      function hideAdmin() {
        document.getElementById('adminPanel').style.display = 'none';
        document.getElementById('rawDataDisplay').style.display = 'none';
      }

      function updateLocationCount() {
        const savedLocations = JSON.parse(localStorage.getItem('locationHistory')) || [];
        document.getElementById('locationCount').textContent = savedLocations.length;
      }

      function viewRawData() {
        const rawDisplay = document.getElementById('rawDataDisplay');
        const savedLocations = JSON.parse(localStorage.getItem('locationHistory')) || [];
        
        if (savedLocations.length === 0) {
          rawDisplay.innerHTML = 'No location data stored.';
        } else {
          rawDisplay.innerHTML = '<pre>' + JSON.stringify(savedLocations, null, 2) + '</pre>';
        }
        
        rawDisplay.style.display = rawDisplay.style.display === 'none' ? 'block' : 'none';
      }

      function clearAllData() {
        if (confirm('‚ö†Ô∏è WARNING: This will permanently delete ALL stored location data. Are you sure?')) {
          localStorage.removeItem('locationHistory');
          alert('All location data has been cleared.');
          updateLocationCount();
          document.getElementById('rawDataDisplay').style.display = 'none';
          
          // Clear markers from map
          markers.forEach(marker => marker.setMap(null));
          markers = [];
        }
      }
    </script>
    
    <script async
      defer
      src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY_HERE&callback=initMap">
    </script>
  </body>
</html>
